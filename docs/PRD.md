## 🍺 AlcoLook — PRD (vNext, Calendar-Integrated Slim)

## 1) 제품 개요

- **목적**: 얼굴 1장 분석으로 **음주 확률%** 제시(참고용) + **다이어리/캘린더 CRUD**로 습관 관리.
- **로컬 우선**: 분석/저장 전부 **온디바이스**, 네트워크/계정 없음.
- **면책(상시 노출)**: 의료/판단 목적 아님, **운전 가능 여부 판단 금지**.

## 2) 현재 스코프(포함/제외)

- 포함
    - **얼굴 분석 파이프라인(더미/간단 규칙 가능)**: CameraX → ML Kit(랜드마크) → `IntoxicationPredictor`(교체형 인터페이스) → 확률%.
    - **다이어리/캘린더 CRUD**: 기록 입력(종류·ABV·용량·수량·메모), 월간/주간 요약, 종류별 통계.
    - **캐릭터 코칭**: 상태(양호/주의/폭음)별 짧은 코멘트.
- 제외
    - Health Connect/심박수, OpenCV 고급 전처리, 모델 학습 세부, 서버·동기화.

## 3) 정보구조 & 내비게이션

### 하단 탭(총 3개)

1. **홈(촬영)**
2. **캘린더** ← *요약 통합*
3. **설정**(오버플로 진입 가능)

### 캘린더 탭 구조(하위 탭)

- 상단 제목: **“음주 기록”** + **[+ 기록 추가]**
- **하위 탭**: **월별** / **통계**
    - **월별**: 월 캘린더(날짜 셀에 상태 컬러·배지) + 하단 **선택일 기록 리스트** + **[요약 보기] 바텀시트**.
    - **통계**: 내부 토글 **주간 요약 / 월간 요약**
        - 상단 **🐶 캐릭터 조언 카드**
        - **건강 지수 카드**(현재 상태 배지 + 프로그레스 + “일평균 x잔”)
        - **주간**: 총 음주량·선호 음주, (있으면) 얼굴 분석 결과 카드(횟수/평균 확률).
        - **월간**: **주별 트렌드(막대)**, **술 종류별 통계(바/칩)**, 얼굴 분석 결과(월간).

## 4) 화면 요건(스샷 일치 지향, 이모지/아이콘 사용)

- **아이콘/이모지**: Material Icons + 플랫폼 이모지(대체 허용).
    - 맵핑 예: 맥주🍺 / 소주🍶(또는 🥃) / 와인🍷 / 위스키🥃 / 하이볼🍹 / 칵테일🍸 / 막걸리🥛 / 기타⭐
- **상태 색상(저채도)**:
    - **주의**: `#FFF4E5` / **폭음**: `#FDEBEC` / 텍스트 대비 ≥ 4.5:1
- **홈(촬영)**: 프리뷰, [촬영], 결과(확률%·코멘트·[공유][결과 기록][다시]) + 면책.
- **월별**:
    - 헤더: ◀︎ **YYYY년 M월** ▶︎(월 이동/데이트피커)
    - 요일 헤더 + 날짜 그리드(기록 도트, 상태 배경), **선택일 기록 카드**(아이콘·ABV·용량·수량·총 ml·메모·편집/삭제).
    - **[요약 보기]** 바텀시트: 선택일 **총 표준잔수**·상태 라벨, **(있으면) AI 최고 확률%**, 캐릭터 조언.
- **통계 → 주간/월간**: 위 3) 구조에 맞춘 카드 레이아웃.

## 5) 기능 사양

- **표준잔수 계산**: `EtOH(g) = volume_ml × abv_% × 0.789`, `std_drinks = EtOH/14`.
- **라벨 규칙(일일)**:
    - 0잔=없음 / ≤2잔=양호 / ≤5잔=주의 / >5잔=폭음 *(단순화 규칙, 프로필에 따라 조정 가능)*
- **캐릭터 코멘트(예)**:
    - 양호: “좋아요! 물도 같이 마셔요 💧” / 주의: “조금 과했어요. 내일은 가볍게!” / 폭음: “수분·수면 먼저 💤”
- **에러/가드**: 얼굴 미검출/역광/흔들림 → 재촬영 안내. 다중 인물 → **최대 얼굴** 사용.

## 6) 데이터 모델(로컬/Room)

- `DrinkType`: {맥주, 소주, 와인, 위스키, 하이볼, 칵테일, 막걸리, 기타} (+ 기본 ABV·용량 옵션)
- `DrinkRecord`: id, date, type, abv, volumeMl, count, note, (옵션) analysisResult{probability}
- 파생/요약: `DailySummary(date, totalMl, totalStdDrinks, status)`
- `UserProfile`: sex{MALE/FEMALE/UNSET}, isSenior65:Boolean, weeklyGoalStdDrinks?:Int

## 7) 기술 스택 & UI

- **Kotlin + Jetpack Compose(M3)**, **CameraX 1.4.x**, **ML Kit(Face Detection/Landmarks)**, **Room**, **Hilt**
- **디자인 원칙**: 스크린샷 톤 재현, 단순 카드·배지·프로그레스. Pretendard 가능 시 적용.
- **접근성**: 라벨·콘트라스트·터치 타깃 44dp 이상.

## 8) 마일스톤 & DoD

- **M0 틀/테마/탭**: 하단 3탭, 다크모드(옵션), 캘린더 탭에 **월별/통계** 하위 탭 구성.
    - *DoD*: 탭 전환·상태 컬러 토큰 동작.
- **M1 캘린더/기록 CRUD**: 월별 그리드, 선택일 리스트/요약 바텀시트, 생성·수정·삭제, **Undo 삭제**.
    - *DoD*: 기록 → 캘린더 배지/상태 실시간 반영.
- **M2 통계(주간/월간)**: 건강 지수, 종류별 통계, 주별 트렌드 차트, 분석 결과 카드(있을 때만).
    - *DoD*: 더미 데이터로 스샷 수준 시연.
- **M3 얼굴 분석 파이프라인**: CameraX→ML Kit→`IntoxicationPredictor(더미)`→결과 화면→다이어리로 [결과 기록].
    - *DoD*: 확률% 표시·공유·기록 연동.

## 9) KPI

- 첫 실행 5분 내 **첫 기록/첫 분석** 달성률
- **[결과 기록] 클릭률**, 공유율
- 주간 재방문(캘린더/분석 중 1+)
- 주간 목표 달성률·스트릭

## 10) 프라이버시

- 카메라 권한만 요청, 모든 데이터 로컬 저장, **전체 삭제** 제공, 면책 상시 노출.

## 11) 한 줄 요약

**3탭(홈/캘린더/설정)** 구조에서 **요약은 캘린더 탭의 하위 탭(월별/통계)**로 통합.

월별은 **달력+선택일 리스트/요약**, 통계는 **주간/월간 요약 카드+차트**로 구성하여 스크린샷과 ≥90% 시각 일치로 구현. (단, 재현 불가능한 컴포넌트의 경우, 현재 개발 환경에서 사용 가능한 것으로 대체)